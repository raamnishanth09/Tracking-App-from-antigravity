import{c as w,g as O,r as h,s as o,j as e,C,B as W,h as M,F as K,a as L,u as g}from"./index-CugQ5QCp.js";import{C as a,c as n,a as y,b as N}from"./card-BhFlIpAy.js";import{u as f}from"./useQuery-kEhrXH_B.js";import{P as B}from"./play-Cr6Kb4dX.js";import{T as R}from"./trending-up-BhmvHNyF.js";import{f as l}from"./format-BuON0pZi.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=w("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=w("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=w("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),A=()=>{var _;const{user:s}=O(),[c,p]=h.useState(!1),[i,b]=h.useState(null),[T,S]=h.useState("00:00:00"),{data:r,refetch:k}=f({queryKey:["today-attendance",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return null;const t=l(new Date,"yyyy-MM-dd"),{data:d}=await o.from("attendance").select("*").eq("user_id",s.id).eq("date",t).maybeSingle();return d},enabled:!!(s!=null&&s.id)}),{data:x=[]}=f({queryKey:["my-tasks",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return[];const{data:t}=await o.from("tasks").select("*").eq("assigned_to",s.id).order("created_at",{ascending:!1}).limit(5);return t||[]},enabled:!!(s!=null&&s.id)}),{data:v=[]}=f({queryKey:["my-work-updates",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return[];const{data:t}=await o.from("work_updates").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(3);return t||[]},enabled:!!(s!=null&&s.id)}),{data:j=[]}=f({queryKey:["my-learning",s==null?void 0:s.id],queryFn:async()=>{if(!(s!=null&&s.id))return[];const{data:t}=await o.from("learning_updates").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).limit(3);return t||[]},enabled:!!(s!=null&&s.id)});h.useEffect(()=>{r!=null&&r.check_in&&!(r!=null&&r.check_out)&&(p(!0),b(r.check_in))},[r]),h.useEffect(()=>{if(!c||!i)return;const t=setInterval(()=>{const d=new Date(i).getTime(),m=Date.now()-d,P=Math.floor(m/(1e3*60*60)),$=Math.floor(m%(1e3*60*60)/(1e3*60)),z=Math.floor(m%(1e3*60)/1e3);S(`${P.toString().padStart(2,"0")}:${$.toString().padStart(2,"0")}:${z.toString().padStart(2,"0")}`)},1e3);return()=>clearInterval(t)},[c,i]);const q=async()=>{if(!(s!=null&&s.id))return;const t=new Date().toISOString(),d=l(new Date,"yyyy-MM-dd"),{error:u}=await o.from("attendance").insert({user_id:s.id,date:d,check_in:t,status:"present"});if(u){g.error("Failed to check in");return}p(!0),b(t),g.success("Checked in successfully!"),k()},D=async()=>{if(!(s!=null&&s.id)||!(r!=null&&r.id))return;const t=new Date().toISOString(),d=new Date(i).getTime(),u=(Date.now()-d)/(1e3*60*60),{error:m}=await o.from("attendance").update({check_out:t,hours_worked:parseFloat(u.toFixed(2))}).eq("id",r.id);if(m){g.error("Failed to check out");return}p(!1),g.success("Checked out successfully!"),k()},I=x.filter(t=>t.status==="pending").length,F=x.filter(t=>t.status==="in_progress").length,E=x.filter(t=>t.status==="completed").length;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-foreground",children:["Welcome back, ",((_=s==null?void 0:s.user_metadata)==null?void 0:_.full_name)||"Team Member","!"]}),e.jsx("p",{className:"text-muted-foreground",children:l(new Date,"EEEE, MMMM d, yyyy")})]})}),e.jsx(a,{className:"border-2 border-primary/20 bg-gradient-to-r from-primary/5 to-transparent",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl gradient-bg flex items-center justify-center",children:e.jsx(C,{className:"w-8 h-8 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Today's Work Time"}),e.jsx("p",{className:"text-4xl font-bold text-foreground font-mono",children:c?T:r!=null&&r.hours_worked?`${r.hours_worked.toFixed(2)} hrs`:"00:00:00"}),i&&c&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Checked in at ",l(new Date(i),"h:mm a")]})]})]}),e.jsx(W,{onClick:c?D:q,size:"lg",className:c?"bg-destructive hover:bg-destructive/90":"bg-green-600 hover:bg-green-700",children:c?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-5 h-5 mr-2"}),"Check Out"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-5 h-5 mr-2"}),"Check In"]})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(a,{children:e.jsxs(n,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center",children:e.jsx(U,{className:"w-6 h-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:I}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Tasks"})]})]})}),e.jsx(a,{children:e.jsxs(n,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:e.jsx(R,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:F}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"In Progress"})]})]})}),e.jsx(a,{children:e.jsxs(n,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 dark:bg-green-900/30 flex items-center justify-center",children:e.jsx(H,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:E}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"})]})]})}),e.jsx(a,{children:e.jsxs(n,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:e.jsx(M,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:j.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Learnings"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{children:[e.jsx(y,{children:e.jsxs(N,{className:"flex items-center gap-2 text-lg",children:[e.jsx(K,{className:"w-5 h-5 text-primary"}),"Recent Work Updates"]})}),e.jsx(n,{children:v.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No work updates yet. Start logging your work!"}):e.jsx("div",{className:"space-y-3",children:v.map(t=>e.jsxs("div",{className:"p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium text-foreground",children:t.title}),e.jsx("span",{className:"text-xs text-muted-foreground",children:l(new Date(t.date),"MMM d")})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.description||"No description"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-muted-foreground",children:[e.jsx(C,{className:"w-3 h-3"}),t.start_time," - ",t.end_time]})]},t.id))})})]}),e.jsxs(a,{children:[e.jsx(y,{children:e.jsxs(N,{className:"flex items-center gap-2 text-lg",children:[e.jsx(M,{className:"w-5 h-5 text-primary"}),"Recent Learning"]})}),e.jsx(n,{children:j.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No learning logs yet. Start tracking your learning!"}):e.jsx("div",{className:"space-y-3",children:j.map(t=>e.jsxs("div",{className:"p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-medium text-foreground",children:t.topic}),e.jsx("span",{className:"text-xs text-muted-foreground",children:l(new Date(t.date),"MMM d")})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:t.key_learnings||t.description||"No notes"})]},t.id))})})]})]}),e.jsxs(a,{children:[e.jsx(y,{children:e.jsxs(N,{className:"flex items-center gap-2 text-lg",children:[e.jsx(L,{className:"w-5 h-5 text-primary"}),"My Tasks"]})}),e.jsx(n,{children:x.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"No tasks assigned yet."}):e.jsx("div",{className:"space-y-2",children:x.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${t.status==="completed"?"bg-green-500":t.status==="in_progress"?"bg-blue-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground",children:t.title}),t.due_date&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Due: ",l(new Date(t.due_date),"MMM d, yyyy")]})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${t.status==="completed"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":t.status==="in_progress"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"}`,children:t.status.replace("_"," ")})]},t.id))})})]})]})};export{A as default};
