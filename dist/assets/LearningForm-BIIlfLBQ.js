import{c as E,g as K,i as Q,r as j,s as u,j as e,h as v,I as c,C as x,B as m,X as k,u as l}from"./index-C9PopRjW.js";import{C as b,a as N,b as w,d as F,c as L}from"./card-Dr7gnhHP.js";import{T as h}from"./textarea-ltqZxKs9.js";import{u as R}from"./useQuery-Cs1p8e55.js";import{L as C,S as z}from"./save-BjF18-kK.js";import{P as B}from"./plus-DZdoEr8Y.js";import{f as p}from"./format-BuON0pZi.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=E("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),X=()=>{const{user:r}=K(),o=Q(),[y,g]=j.useState(!1),[t,n]=j.useState({topic:"",description:"",keyLearnings:"",startTime:"",endTime:"",links:[""],notes:""}),{data:f=[]}=R({queryKey:["today-learning",r==null?void 0:r.id],queryFn:async()=>{if(!(r!=null&&r.id))return[];const s=p(new Date,"yyyy-MM-dd"),{data:a}=await u.from("learning_updates").select("*").eq("user_id",r.id).eq("date",s).order("created_at",{ascending:!1});return a||[]},enabled:!!(r!=null&&r.id)}),T=()=>{n({...t,links:[...t.links,""]})},q=s=>{const a=t.links.filter((i,d)=>d!==s);n({...t,links:a.length?a:[""]})},M=(s,a)=>{const i=[...t.links];i[s]=a,n({...t,links:i})},S=async s=>{if(s.preventDefault(),!(r!=null&&r.id))return;if(!t.topic.trim()){l.error("Please enter a topic");return}g(!0);const a=p(new Date,"yyyy-MM-dd"),i=t.links.filter(A=>A.trim()),{error:d}=await u.from("learning_updates").insert({user_id:r.id,topic:t.topic.trim(),description:t.description.trim()||null,key_learnings:t.keyLearnings.trim()||null,date:a,start_time:t.startTime||null,end_time:t.endTime||null,links:i.length?i:null,notes:t.notes.trim()||null});if(g(!1),d){l.error("Failed to save learning update"),console.error(d);return}l.success("Learning update saved!"),n({topic:"",description:"",keyLearnings:"",startTime:"",endTime:"",links:[""],notes:""}),o.invalidateQueries({queryKey:["today-learning"]}),o.invalidateQueries({queryKey:["my-learning"]})},D=async s=>{const{error:a}=await u.from("learning_updates").delete().eq("id",s);if(a){l.error("Failed to delete");return}l.success("Deleted!"),o.invalidateQueries({queryKey:["today-learning"]}),o.invalidateQueries({queryKey:["my-learning"]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Learning Updates"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your learning journey and key takeaways"})]}),e.jsxs(b,{children:[e.jsxs(N,{children:[e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5 text-primary"}),"Log Learning Activity"]}),e.jsx(F,{children:p(new Date,"EEEE, MMMM d, yyyy")})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-1 block",children:"Topic / Subject *"}),e.jsx(c,{placeholder:"What did you learn about?",value:t.topic,onChange:s=>n({...t,topic:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-1 block",children:"Description"}),e.jsx(h,{placeholder:"Brief overview of what you studied...",value:t.description,onChange:s=>n({...t,description:s.target.value}),rows:2})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-foreground mb-1 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-yellow-500"}),"Key Takeaways"]}),e.jsx(h,{placeholder:"What are the main things you learned? Key insights, concepts, or skills...",value:t.keyLearnings,onChange:s=>n({...t,keyLearnings:s.target.value}),rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-1 block",children:"Start Time (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(c,{type:"time",value:t.startTime,onChange:s=>n({...t,startTime:s.target.value}),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-1 block",children:"End Time (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(c,{type:"time",value:t.endTime,onChange:s=>n({...t,endTime:s.target.value}),className:"pl-10"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-1 block",children:"Resource Links"}),e.jsxs("div",{className:"space-y-2",children:[t.links.map((s,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(c,{type:"url",placeholder:"https://...",value:s,onChange:i=>M(a,i.target.value),className:"pl-10"})]}),t.links.length>1&&e.jsx(m,{type:"button",variant:"outline",size:"icon",onClick:()=>q(a),children:e.jsx(k,{className:"w-4 h-4"})})]},a)),e.jsxs(m,{type:"button",variant:"outline",size:"sm",onClick:T,className:"w-full",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Add Resource Link"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-1 block",children:"Additional Notes"}),e.jsx(h,{placeholder:"Any other notes, questions, or areas to explore further...",value:t.notes,onChange:s=>n({...t,notes:s.target.value}),rows:2})]}),e.jsxs(m,{type:"submit",className:"w-full",disabled:y,children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),y?"Saving...":"Save Learning Update"]})]})})]}),e.jsxs(b,{children:[e.jsx(N,{children:e.jsx(w,{children:"Today's Learning"})}),e.jsx(L,{children:f.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-6",children:"No learning logged today. Start tracking your progress!"}):e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsx("div",{className:"p-4 rounded-lg border bg-card hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-medium text-foreground flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-primary"}),s.topic]}),s.description&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:s.description}),s.key_learnings&&e.jsx("div",{className:"mt-2 p-2 rounded bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800",children:e.jsxs("p",{className:"text-sm text-foreground flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-yellow-500 mt-0.5 flex-shrink-0"}),s.key_learnings]})}),(s.start_time||s.end_time)&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-muted-foreground",children:[e.jsx(x,{className:"w-4 h-4"}),s.start_time&&s.end_time?`${s.start_time} - ${s.end_time}`:s.start_time||s.end_time]}),s.links&&s.links.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:s.links.map((a,i)=>e.jsxs("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),"Resource ",i+1]},i))})]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>D(s.id),className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:e.jsx(k,{className:"w-4 h-4"})})]})},s.id))})})]})]})};export{X as default};
